<!doctype html> <html lang=en> <head> <meta charset=UTF-8> <title>Number Clock</title> <style type=text/css>body,html{touch-action:none;content-zooming:none;margin:0;padding:0;background:#333;position:absolute;width:100%;height:100%}#screen{width:100%;height:100%;margin:auto auto;position:fixed;top:0;bottom:0;left:0;right:0;background:#000;cursor:pointer}</style> </head> <body> <canvas id=screen></canvas> <script>!function(){"use strict";var c={elem:document.getElementById("screen"),width:0,height:0,top:0,left:0,resize:function(){var t=c.elem;for(c.width=t.offsetWidth,c.height=t.offsetHeight,c.left=0,c.top=0;null!=t;t=t.offsetParent)c.left+=t.offsetLeft,c.top+=t.offsetTop;c.elem.width=c.width,c.elem.height=c.height,l&&(l.deleteStatic(),l.rectangle(c.width/2,c.height+50,c.width,100,0,0),l.rectangle(c.width/2,2*-c.height,c.width,100,0,0),l.rectangle(-50,0,100,4*c.height,0,0),l.rectangle(c.width+50,0,100,4*c.height,0,0))}};c.elem.onselectstart=function(){return!1},c.elem.ondrag=function(){return!1};var i=c.elem.getContext("2d");window.addEventListener("resize",c.resize,!1);var s={pos:{x:0,y:0},active:!1,down:function(t,i){t.preventDefault();var s=i?t.touches[0]:t;!i&&document.setCapture&&document.setCapture(),this.pos.x=s.clientX-c.left,this.pos.y=s.clientY-c.top,this.active=!0},up:function(t,i){t.preventDefault(),!i&&document.releaseCapture&&document.releaseCapture(),this.active=!1},move:function(t,i){t.preventDefault();var s=i?t.touches[0]:t;this.active&&(this.pos.x=s.clientX-c.left,this.pos.y=s.clientY-c.top)}};function n(t,i){this.x=t||0,this.y=i||0}function t(){this.cos=0,this.sin=0,this.pos=new n,this.ang=0}"ontouchstart"in window&&(c.elem.ontouchstart=function(t){s.down(t,!0)}.bind(s),c.elem.ontouchmove=function(t){s.move(t,!0)}.bind(s),c.elem.ontouchend=function(t){s.up(t,!0)}.bind(s),c.elem.ontouchcancel=function(t){s.up(t,!0)}.bind(s)),document.addEventListener("mousedown",function(t){s.down(t,!1)}.bind(s),!0),document.addEventListener("mousemove",function(t){s.move(t,!1)}.bind(s),!0),document.addEventListener("mouseup",function(t){s.up(t,!1)}.bind(s),!0),n.prototype={set:function(t,i){return this.x=t,this.y=i,this},dot:function(t){return this.x*t.x+this.y*t.y},lenSqr:function(){return this.x*this.x+this.y*this.y},transform:function(t,i){return this.x=i.cos*t.x-i.sin*t.y+i.pos.x,this.y=i.sin*t.x+i.cos*t.y+i.pos.y,this},rotate:function(t,i){return this.x=i.cos*t.x-i.sin*t.y,this.y=i.sin*t.x+i.cos*t.y,this},normal:function(t,i){var s=t.x-i.x,e=t.y-i.y,n=Math.sqrt(s*s+e*e);return this.x=-e/n,this.y=s/n,this},project:function(t,i,s){var e=t.x-i.x,n=t.y-i.y,h=Math.sqrt(e*e+n*n);return-n/h*s.x+e/h*s.y},addScale:function(t,i,s){return this.x=t.x+i.x*s,this.y=t.y+i.y*s,this},subScale:function(t,i,s){return this.x=t.x-i.x*s,this.y=t.y-i.y*s,this},add:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this},sub:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this},scale:function(t,i){return this.x=t.x*i,this.y=t.y*i,this},perp:function(){var t=this.x;return this.x=-this.y,this.y=t,this},inv:function(t){return this.x=-t.x,this.y=-t.y,this},clamp:function(t,i,s){return s<t?t=s:t<i&&(t=i),t},rotateIntoSpaceOf:function(t,i){var s=-t.x,e=-t.y;return this.x=s*i.cos+e*i.sin,this.y=s*-i.sin+e*i.cos,this},array:function(t,i){var s=new Array(t);s.min=new n,s.max=new n;for(var e=0;e<t;e++)s[e]=new n(i?i[2*e+0]:0,i?i[2*e+1]:0);return s.transform=function(t,i){for(var s=0,e=this.length;s<e;s++){var n=t[s],h=this[s],o=i.cos*n.x-i.sin*n.y+i.pos.x,a=i.sin*n.x+i.cos*n.y+i.pos.y;o<this.min.x&&(this.min.x=o),a<this.min.y&&(this.min.y=a),o>this.max.x&&(this.max.x=o),a>this.max.y&&(this.max.y=a),h.x=o,h.y=a}return this},s.rotate=function(t,i){for(var s=0,e=this.length;s<e;s++){var n=t[s],h=this[s];h.x=i.cos*n.x-i.sin*n.y,h.y=i.sin*n.x+i.cos*n.y}return this},s.resetMinmax=function(){this.min.x=1e5,this.min.y=1e5,this.max.x=-1e5,this.max.y=-1e5},s.normal=function(t){for(var i=0;i<this.length;i++)this[i].normal(t[(i+1)%this.length],t[i]);return this},s}},t.prototype={set:function(t,i,s,e,n){return this.cos=Math.cos(t),this.sin=Math.sin(t),this.ang=t,this.pos.x=i,this.pos.y=s,this.w=e,this.h=n,this},copy:function(t){return this.cos=t.cos,this.sin=t.sin,this.ang=t.ang,this.pos.x=t.pos.x,this.pos.y=t.pos.y,this},integrate:function(t,i,s,e){return this.pos.x+=i*e,this.pos.y+=s*e,this.ang+=t*e,this.cos=Math.cos(this.ang),this.sin=Math.sin(this.ang),this}};var l=function(n,h,r,c){var l=[],o=!1,v=new r,x=new r,a=new r,u=new r,d=(new r,new r),y=[];function p(){this.x=0,this.y=0,this.w=0,this.h=0}function m(t,i,s,e,n,h,o,a){this.img=a,this.vel=new r,this.angularVel=0,this.invMass=h,this.matrix=(new c).set(o,t,i,s,e),this.aabb=new p,this.drag=!1,this.static=!1,this.length=n.length/2|0,this.localSpacePoints=(new r).array(this.length,n),this.localSpaceNormals=(new r).array(this.length).normal(this.localSpacePoints),this.worldSpaceNormals=(new r).array(this.length),this.worldSpacePoints=(new r).array(this.length),this.invI=0<h?1/(1/h*(s*s+e*e)/3):0,this.c1=new r,this.c0=new r,l.push(this)}function t(){this.dist=0,this.closestI=0,this.edge=0,this.fpc=0}y.index=0,y.create=function(t,i,s,e,n,h){this[this.index]||(this[this.index]=new f),this[this.index++].set(t,i,s,e,n,h)},m.prototype={motionAABB:function(){this.worldSpacePoints.resetMinmax(),this.worldSpacePoints.transform(this.localSpacePoints,this.matrix),this.worldSpaceNormals.rotate(this.localSpaceNormals,this.matrix);var t=this.worldSpacePoints.min,i=this.worldSpacePoints.max;this.aabb.x=.5*(t.x+i.x),this.aabb.y=.5*(t.y+i.y),this.aabb.w=.5*(i.x-t.x),this.aabb.h=.5*(i.y-t.y)},contact:function(t){var i,s,e,n,h,o,a,r,c,l,u,d,p,m,f;g.set(1e5,-1,-1,0,1e5),w.set(-1e5,-1,-1,0,1e5),this.featurePairJudgement(t,2),t.featurePairJudgement(this,1),0<g.dist&&0!==g.fpc?(i=g.edge,s=g.closestI,h=g.fpc):w.dist<=0&&(i=w.edge,s=w.closestI,h=w.fpc),u=(n=1===h?(e=this,t):(e=t,this)).worldSpaceNormals[i],o=e.worldSpacePoints[(s-1+e.length)%e.length],a=e.worldSpacePoints[s],r=e.worldSpacePoints[(s+1)%e.length],p=v.project(a,o,u)<x.project(r,a,u)?(d=o,a):(d=a,r),m=n.worldSpacePoints[i],f=n.worldSpacePoints[(i+1)%n.length],l=1===h?(this.projectPointOntoEdge(m,f,d,p),t.projectPointOntoEdge(p,d,m,f),c=-u.x,-u.y):(this.projectPointOntoEdge(p,d,m,f),t.projectPointOntoEdge(m,f,d,p),c=u.x,u.y),y.create(this,t,this.c0,t.c0,c,l),y.create(this,t,this.c1,t.c1,c,l)},featurePairJudgement:function(t,i){for(var s,e=0;e<this.length;e++){s=this.worldSpaceNormals[e],d.rotateIntoSpaceOf(s,t.matrix);for(var n=-1,h=-1e5,o=0;o<t.length;o++){var a=d.dot(t.localSpacePoints[o]);h<a&&(h=a,n=o)}var r,c=t.worldSpacePoints[n];v.sub(c,this.worldSpacePoints[e]),0<(r=v.dot(s))?(x.sub(c,this.worldSpacePoints[(e+1)%this.length]),(r=this.projectPointOntoEdgeZero(v,x).lenSqr())<g.dist&&g.set(r,n,e,i)):r>w.dist&&w.set(r,n,e,i)}},projectPointOntoEdge:function(t,i,s,e){var n=a.sub(e,s).lenSqr()+1e-7;this.c0.addScale(s,a,u.clamp(u.sub(t,s).dot(a)/n,0,1)),this.c1.addScale(s,a,u.clamp(u.sub(i,s).dot(a)/n,0,1))},projectPointOntoEdgeZero:function(t,i){var s=a.sub(i,t).lenSqr()+1e-7;return this.c0.addScale(t,a,u.clamp(u.inv(t).dot(a)/s,0,1))},integrate:function(){this.drag?(this.vel.x+=h.pos.x-this.matrix.pos.x,this.vel.y+=h.pos.y-this.matrix.pos.y):0<this.invMass&&(this.vel.y+=5),this.matrix.integrate(this.angularVel,this.vel.x,this.vel.y,1/60),this.static?0===this.invMass&&(this.static=!0,this.motionAABB()):this.motionAABB()},draw:function(){if(this.img){var t=this.matrix;if(n.save(),n.translate(t.pos.x,t.pos.y),n.rotate(t.ang),n.drawImage(this.img,.5*-t.w,.5*-t.h,t.w,t.h),n.restore(),h.active){if(!o&&this.invMass){n.beginPath();for(var i=0;i<this.length;i++){var s=this.worldSpacePoints[i];n.lineTo(s.x,s.y)}n.closePath(),n.isPointInPath(h.pos.x,h.pos.y)&&(this.drag=!0,o=!0)}}else if(o){for(var e=0;e<l.length;e++)l[e].drag=!1;o=!1}}}},t.prototype.set=function(t,i,s,e){this.dist=t,this.closestI=i,this.edge=s,this.fpc=e};var g=new t,w=new t;function f(){this.a=null,this.b=null,this.normal=new r,this.normalPerp=new r,this.ra=new r,this.rb=new r,this.dist=0,this.impulseN=0,this.impulseT=0,this.invDenom=0,this.invDenomTan=0}return f.prototype={set:function(t,i,s,e,n,h){var o,a;this.a=t,this.b=i,this.normal.set(n,h),this.normalPerp.set(-h,n),this.dist=x.sub(e,s).dot(this.normal),this.impulseN=0,this.impulseT=0,this.ra.sub(s,t.matrix.pos).perp(),this.rb.sub(e,i.matrix.pos).perp(),o=this.ra.dot(this.normal),a=this.rb.dot(this.normal),this.invDenom=1/(t.invMass+i.invMass+o*o*t.invI+a*a*i.invI),o=this.ra.dot(this.normalPerp),a=this.rb.dot(this.normalPerp),this.invDenomTan=1/(t.invMass+i.invMass+o*o*t.invI+a*a*i.invI)},applyImpulse:function(t){this.a.vel.addScale(this.a.vel,t,this.a.invMass),this.b.vel.subScale(this.b.vel,t,this.b.invMass),this.a.angularVel+=t.dot(this.ra)*this.a.invI,this.b.angularVel-=t.dot(this.rb)*this.b.invI},solve:function(){var t,i,s=x;s.sub(a.addScale(this.b.vel,this.rb,this.b.angularVel),u.addScale(this.a.vel,this.ra,this.a.angularVel)),0<(t=(s.dot(this.normal)+this.dist/(1/60))*this.invDenom+this.impulseN)&&(t=0),this.applyImpulse(a.scale(this.normal,t-this.impulseN)),this.impulseN=t,i=.5*Math.abs(this.impulseN),t=a.clamp(s.dot(this.normalPerp)*this.invDenomTan+this.impulseT,-i,i),this.applyImpulse(u.scale(this.normalPerp,t-this.impulseT)),this.impulseT=t}},{render:function(){for(var t=y.index=0,i=l.length;t<i-1;t++)for(var s=l[t],e=t+1;e<i;e++){var n=l[e];if(s.invMass||n.invMass){var h=s.aabb,o=n.aabb;Math.abs(o.x-h.x)-(h.w+o.w)<0&&Math.abs(o.y-h.y)-(h.h+o.h)<0&&s.contact(n)}}for(i=y.index,e=0;e<5;e++)for(t=0;t<i;t++)y[t].solve();for(t=0,i=l.length;t<i;t++)l[t].integrate();for(t=0;t<i;t++)l[t].draw()},rectangle:function(t,i,s,e,n,h,o){return new m(t,i,s,e,[s/2,-e/2,-s/2,-e/2,-s/2,e/2,s/2,e/2],n?1/n:0,h,o)},deleteStatic:function(){for(var t=l.length;t--;){l[t].invMass||l.splice(t,1)}},number:function(t,i,s){var e=document.createElement("canvas"),n=e.getContext("2d");return e.width=t,e.height=i,n.font="bold "+.92*t+"px arial",n.fillStyle=b,n.fillText(s,0,.97*i),e},delete:function(t){for(var i=0,s=l.length;i<s;i++)if(l[i]===t)return void l.splice(i,1)}}}(i,s,n,t);function u(t){return 9<t?""+t:"0"+t}c.resize();var d,p,m="",f="",b="",v=0,x=0,y=[];function g(t,i,s,e,n){var h=.69*t|0,o=l.number(t,h,s);return l.rectangle(i,-t,t,h,e,n,o)}function e(){var t,i,s,e,n=new Date,h=u(n.getHours()),o=u(n.getMinutes()),a=u(n.getSeconds());if(h!=m&&(v=360*Math.random()|0,b="hsl("+v+", 70%, 80%)",t=c.width/3|0,l.delete(d),d=g(t,1.2*t,h,1,0),m=h),o!=f){v=360*Math.random()|0,b="hsl("+v+", 70%, 60%)",i=.69*(t=c.width/3|0)|0,s=l.number(t,i,h),d.img=s,t=c.width/5|0,l.delete(p),p=g(t,c.width-1.2*t,o,1,0),f=o;for(var r=0;r<y.length;r++)setTimeout(function(){l.delete(y.shift())},60*r);x=0}b="hsl("+v+",70%,"+(20+80*Math.random()|0)+"%)",e=g(t=c.width/15|0,t+x*t%(c.width-2*t),a,.1,2*Math.random()*Math.PI),y.push(e),x++}e(),setInterval(e,1e3),requestAnimationFrame(function t(){requestAnimationFrame(t),i.clearRect(0,0,c.width,c.height),l.render()})}()</script> <div style=display:none> <script src="https://s95.cnzz.com/z_stat.php?id=1260545070&web_id=1260545070"></script> </div> <script type="text/javascript" src="../NumberClock/NumberClock.bundle.8b97fef7c3b331417ab0.js?8b97fef7c3b331417ab0"></script></body> </html>